{% load custom_tags %}

{% if first %}
  {% include 'componentTemplates/Heading.html' with classes="finding-heading" %}
{% endif %}
<table id="finding-{{ finding.id }}" scoring-type="CVSS" class="finding" finding-severity="{{ finding.severity }}">
    <tr class='finding-header'>
        <td class='finding-severity background-color-severity'>
            {{ finding.score }}
            <br />
            {{ finding.severity }}
        </td>
        <td class='finding-title'>
            {% if showFindingNumbers %}[{{ finding.number }}] {% endif %}{{ finding.name }}
        </td>
    </tr>
    {% if showVector %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                vector
            </td>
            <td class='finding-content-body'>
                {{ finding.cvss.vector }}
            </td>
        </tr>
    {% endif %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Category
            </td>
            <td class='finding-content-body' style='font-weight: bold'>
                {{ finding.categoryFull }}
            </td>
        </tr>
    {% if finding.affectedResources %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Affected Resources
            </td>
            <td class='finding-content-body'>
                {% markdown finding.affectedResources %}
            </td>
        </tr>
    {% endif %}
    {% if finding.description %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Description
            </td>
            <td class='finding-content-body'>
                {% markdown finding.description %}
            </td>
        </tr>
    {% endif %}
    {% if finding.background %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Background
            </td>
            <td class='finding-content-body'>
                {% markdown finding.background %}
            </td>
        </tr>
    {% endif %}
    {% if finding.toolsUsed %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Tools Used
            </td>
            <td class='finding-content-body'>
                {% markdown finding.toolsUsed %}
            </td>
        </tr>
    {% endif %}
    {% if finding.proofOfConcept %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Proof of Concept
            </td>
            <td class='finding-content-body'>
                {% markdown finding.proofOfConcept %}
            </td>
        </tr>
    {% endif %}
    {% if finding.remediation %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                Remediation
            </td>
            <td class='finding-content-body'>
                {% markdown finding.remediation %}
            </td>
        </tr>
    {% endif %}
    {% if finding.references %}
        <tr class='finding-content'>
            <td class='finding-content-header'>
                References
            </td>
            <td class='finding-content-body'>
                {% markdown finding.references %}
            </td>
        </tr>
    {% endif %}
</table>
{% for figure in finding.figures_ending %} {% include 'reportTemplates/figure.html' with figure=figure %}
{% endfor %}

